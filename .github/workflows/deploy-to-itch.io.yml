name: Publish on Itch.IO  ðŸŽ®
on: [workflow_call, workflow_dispatch]

jobs:
  itchio-deploy:
      name: Deploy to Itch.IO  ðŸŽ®
      runs-on: ubuntu-lateste
      steps:
       - name: Checkout code
         uses: actions/checkout@v3
         
       - name: Setup Node.js 16
         uses: actions/setup-node@v2
         with:
           node-version: "16.x"
           cache: 'npm'
           cache-dependency-path: typescript-project/yarn.lock
           
       - uses: actions/download-artifact@v3
         with:
           name: build-ItchIO
           path: build/WebGL

       - name: Display structure of root files
         run: ls -R
         working-directory: build/WebGL
         
       - uses: manleydev/butler-publish-itchio-action@master
      
      env:
        BUTLER_CREDENTIALS: ${{ secrets.BUTLER_CREDENTIALS }}
        CHANNEL: windows
        ITCH_GAME: example-project
        ITCH_USER: username
        PACKAGE: build/WebGL    

          
